"use strict";(self.webpackChunkapache_teaclave_incubating=self.webpackChunkapache_teaclave_incubating||[]).push([[8213],{5672:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"codebase/docker","title":"Teaclave Docker","description":"This directory contains the docker infrastructure for build and runtime","source":"@site/docs/codebase/docker.md","sourceDirName":"codebase","slug":"/codebase/docker","permalink":"/docs/codebase/docker","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/incubator-teaclave-website/tree/master/sgx-sdk-api-docs/docs/codebase/docker.md","tags":[],"version":"current","frontMatter":{"permalink":"/docs/codebase/docker"},"sidebar":"tutorialSidebar","previous":{"title":"Data Center Attestation Service","permalink":"/docs/codebase/dcap"},"next":{"title":"Teaclave Documentation","permalink":"/docs/codebase/docs"}}');var c=r(4848),a=r(8453);const s={permalink:"/docs/codebase/docker"},i="Teaclave Docker",o={},d=[{value:"Build",id:"build",level:2},{value:"Runtime",id:"runtime",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"teaclave-docker",children:"Teaclave Docker"})}),"\n",(0,c.jsx)(n.p,{children:"This directory contains the docker infrastructure for build and runtime\r\nenvironment. Note that you must mount SGX device and ASEM domain socket into the\r\ncontainer environment to use SGX feature."}),"\n",(0,c.jsx)(n.h2,{id:"build",children:"Build"}),"\n",(0,c.jsxs)(n.p,{children:["The build dockerfile (",(0,c.jsx)(n.code,{children:"build.*.Dockerfile"}),") only contains minimal dependencies\r\nto build and test the project. To use them, you can directly use pre-built\r\ndocker images from Docker Hub with:"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"$ docker run --rm \\\r\n  --device=/dev/isgx \\\r\n  -v/var/run/aesmd/aesm.socket:/var/run/aesmd/aesm.socket \\\r\n  -v`pwd`:/teaclave \\\r\n  -w /teaclave \\\r\n  -it teaclave/teaclave-build-ubuntu-1804-sgx-2.17.1:latest \\\r\n  /bin/bash\n"})}),"\n",(0,c.jsxs)(n.p,{children:["or you can also build the image by yourself with ",(0,c.jsx)(n.code,{children:"docker build"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"$ docker build -t teaclave-build - < build.*.Dockerfile\n"})}),"\n",(0,c.jsx)(n.p,{children:"and run:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"$ docker run --rm \\\r\n  --device=/dev/isgx \\\r\n  -v/var/run/aesmd/aesm.socket:/var/run/aesmd/aesm.socket \\\r\n  -v`pwd`:/teaclave \\\r\n  -w /teaclave \\\r\n  -it teaclave/teaclave-build \\\r\n  /bin/bash\n"})}),"\n",(0,c.jsx)(n.h2,{id:"runtime",children:"Runtime"}),"\n",(0,c.jsxs)(n.p,{children:["Teaclave contains many services, we put services, config and related\r\nresources into one docker image\r\n(",(0,c.jsx)(n.code,{children:"teaclave-rt.ubuntu-1804.Dockerfile"}),"). To make the deployment\r\nsimpler, we recommend to use ",(0,c.jsx)(n.a,{href:"https://docs.docker.com/compose/",children:"docker-compose"}),"\r\nto manage all services. Since the remote attestation is required for all\r\nservices, you should setup the attestation service configurations\r\nbefore start the services. You can use env vars or set them in the\r\n",(0,c.jsx)(n.code,{children:"docker-compose-ubuntu-1804.yml"})," file."]}),"\n",(0,c.jsx)(n.p,{children:"Here is an example to start all services."}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:'$ export AS_SPID="00000000000000000000000000000000"\r\n$ export AS_KEY="00000000000000000000000000000000"\r\n$ export AS_ALGO="sgx_epid"\r\n$ export AS_URL="https://api.trustedservices.intel.com:443"\r\n\r\n$ ./run-teaclave-services.sh\r\nStarting teaclave-file-service           ... done\r\nStarting teaclave-authentication-service ... done\r\nStarting teaclave-access-control-service ... done\r\nStarting teaclave-scheduler-service      ... done\r\nStarting teaclave-management-service     ... done\r\nStarting teaclave-execution-service      ... done\r\nStarting teaclave-frontend-service       ... done\r\nAttaching to ...\n'})}),"\n",(0,c.jsxs)(n.p,{children:["Note that the ",(0,c.jsx)(n.code,{children:"teaclave-file-service"})," container is a simple http server for\r\ndemonstrating our examples. You can disable it and use other cloud file system\r\nlike S3 instead for registering input/output files."]})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(l,{...e})}):l(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>i});var t=r(6540);const c={},a=t.createContext(c);function s(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:s(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);